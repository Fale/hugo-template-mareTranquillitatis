{{ define "title" }}{{ .Title }} &ndash; {{ .Site.Title }}{{ end }}

{{ define "main" }}
<article class="card" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    <meta itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" content="{{ .Permalink }}"/>
    <meta itemprop="dateModified" content="{{ .Date.Format "2006-01-02T15:04:05-07:00" }}">
    <meta itemprop="datePublished" content="{{ .Date.Format "2006-01-02T15:04:05-07:00" }}">
    <meta itemprop="headline" content="{{ .Title }}">
    <meta itemprop="description" content="{{ .Summary }}">
    <meta itemprop="url" content="{{ .Permalink }}">
    <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
        <meta itemprop="url" content="{{ $.Site.BaseURL }}{{ .Params.Image }}"/>
    </div>
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Person">
        <meta itemprop="name" content="{{ .Site.Params.Author.Name }}">
    </div>
    <div itemprop="author" itemscope itemtype="https://schema.org/Person">
        <meta itemprop="name" content="{{ .Site.Params.Author.Name }}">
        <meta itemprop="givenName" content="{{ .Site.Params.Author.GivenName }}">
        <meta itemprop="familyName" content="{{ .Site.Params.Author.FamilyName }}">
        <meta itemprop="birthdate" content="{{ .Site.Params.Author.Birthdate }}">
        <meta itemprop="jobTitle" content="{{ .Site.Params.Author.JobTitle }}">
        {{- range $item := .Site.Params.Author.HasOccupation }}
        <div itemprop="hasOccupation" itemscope itemtype="https://schema.org/Occupation">
            <meta itemprop="name" content="{{ $item.Name }}">
            <div itemprop="occupationalCategory" itemscope itemtype="https://schema.org/CategoryCode">
                <meta itemprop="codeValue" content="{{ $item.CodeValue }}">
                <meta itemprop="name" content="{{ $item.CodeName }}">
                <meta itemprop="url" content="https://www.onetonline.org/link/summary/{{ $item.CodeValue }}">
            </div>
        </div>
        {{- end }}
        <meta itemprop="url" content="{{ .Site.Params.Author.URL }}">
        {{- range $item := .Site.Params.Author.SameAs }}
        <meta itemprop="sameAs" content="{{ $item }}">
        {{- end }}
        <div itemprop="worksFor" itemscope itemtype="https://schema.org/Organization">
            <meta itemprop="name" content="{{ .Site.Params.Author.WorksFor.Name }}">
            <meta itemprop="url" content="{{ .Site.Params.Author.WorksFor.URL }}">
            <span itemprop="employee" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="jobTitle" content="{{ .Site.Params.Author.WorksFor.Role }}">
                <meta itemprop="name" content="{{ .Site.Params.Author.Name }}">
            </span>
        </div>
    </div>
    {{ if .Params.Image }}<img class="cover" src="{{ .Params.Image }}" alt="">{{ end }}
    <h1>{{ .Title }}</h1>
    <p>{{ if not .Date.IsZero }}<span class="fas fa-fw">&#xf017;</span> {{ $.Date.Format "January 2, 2006" }}{{ end }} {{ if .Params.location }} - <span class="fas">&#xf0ac;</span> {{ .Params.location.city }}, {{ .Params.location.country }}{{ end }}
    </p>

    {{ .Content }}

    {{ if .Params.categories }}
    <div class="section">
        <span class="fas">&#xf07b;</span> {{ range $i, $e := sort .Params.categories }}{{if $i}}, {{end}}<a href="{{ $.Site.BaseURL}}/categories/{{ $e | urlize }}" class="tag">{{ $e }}</a>{{ end }}
    </div>
    {{ end }}
    {{ if .Params.tags }}
    <div class="section">
        <span class="fas">&#xf02b;</span> {{ range $i, $e := sort .Params.tags }}{{if $i}}, {{end}}<a href="{{ $.Site.BaseURL}}/tags/{{ $e | urlize }}" class="tag">{{ $e }}</a>{{ end }}
    </div>
    {{ end }}

    <aside>
        <section id="share">
            <h2>Share</h2>
            <a target="_blank" href="http://www.facebook.com/sharer.php?src=bm&u={{ .Permalink }}&t={{ .Title }}"><span class="fab fa-fw">&#xf09a;</span></a>
            <a target="_blank" href="http://twitter.com/intent/tweet?url={{ .Permalink }}&text={{ .Title }}&tw_p=tweetbutton"><span class="fab fa-fw">&#xf099;</span></a>
            <a target="_blank" href="http://getpocket.com/edit?url={{ .Permalink }}&title={{ .Title }}"><span class="fab fa-fw">&#xf265;</span></a>
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url={{ .Permalink }}&title={{ .Title }}"><span class="fab fa-fw">&#xf08c;</span></a>
        </section>

        <section id="see-also">
            {{ $related := .Site.RegularPages.Related . | first 5 }}
            {{ with $related }}
            <h2>See Also</h2>
            <ul>
                {{ range . }}
                <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
                {{ end }}
            </ul>
            {{ end }}
        </section>

        {{ if not (isset .Params "no_comments") }}
        <section id="comments">
            {{ $resource := (replace (substr .RelPermalink "1" "-1") "/" "_") }}
            <h2 id="say-something">Say something</h2>
            <form id="comment">
                <input type="hidden" id="comment-resource" value="{{ $resource }}">
                <input type="text" id="comment-name" placeholder="Your name">
                <input type="email" id="comment-email" placeholder="Your email">
                <textarea id="comment-body" rows="10" placeholder="Your message. Feel free to use Markdown."></textarea>
                <span id="comment-submit" class="button">Submit</span>
            </form>
            {{ with resources.Get "js/swlcs.js" | resources.ExecuteAsTemplate "swlcs.js" . | minify }}<script nonce="swlcs">{{ .Content | safeJS }}</script>{{ end }}
            <h2>Comments</h2>
            {{ $comments := index $.Site.Data.comments $resource }}
            {{ range $comments }}
            <div class="card">
                <strong>{{ .name }}</strong> on {{ (time .date).Format "2006-01-02 15:04:05 MST" }} said:
                <p>{{ .body | $.Site.GetPage.RenderString }}</p>
            </div>
            {{ else }}
            <p>Nothing yet.</p>
            {{ end }}
        </section>
        {{ end }}
    </aside>
</article>
{{ end }}
